<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Grunteo - Edycja działki</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <link rel="icon" type="image/svg+xml" href="https://raw.githubusercontent.com/trainingtwenty5/karuzo/main/brand/logo-mark.svg" />
  <link rel="apple-touch-icon" sizes="180x180" href="https://raw.githubusercontent.com/trainingtwenty5/karuzo/main/brand/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="https://raw.githubusercontent.com/trainingtwenty5/karuzo/main/brand/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="https://raw.githubusercontent.com/trainingtwenty5/karuzo/main/brand/favicon-16x16.png" />
  <link rel="manifest" href="https://raw.githubusercontent.com/trainingtwenty5/karuzo/main/brand/site.webmanifest" />
  <link rel="mask-icon" href="https://raw.githubusercontent.com/trainingtwenty5/karuzo/main/brand/safari-pinned-tab.svg" color="#0c0d11" />
  <link rel="shortcut icon" href="https://raw.githubusercontent.com/trainingtwenty5/karuzo/main/brand/favicon.ico" />
  <meta name="apple-mobile-web-app-title" content="Grunteo" />
  <meta name="application-name" content="Grunteo" />
  <meta name="msapplication-TileColor" content="#0c0d11" />
  <meta name="msapplication-config" content="https://raw.githubusercontent.com/trainingtwenty5/karuzo/main/brand/browserconfig.xml" />
  <meta name="theme-color" content="#0c0d11" />
  <meta property="og:image" content="https://raw.githubusercontent.com/trainingtwenty5/karuzo/main/brand/og-image.png" />
  <meta property="og:image:type" content="image/png" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
  <meta property="og:image:alt" content="Logo Grunteo" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:image" content="https://raw.githubusercontent.com/trainingtwenty5/karuzo/main/brand/og-image.png" />
  <link rel="stylesheet" href="assets/main.css" />
  <link rel="stylesheet" href="assets/header.css" />
  <link rel="stylesheet" href="assets/details.css" />
  <link rel="stylesheet" href="assets/edit.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.8.0/proj4.js"></script>
</head>
<body class="property-page" style="padding-top: calc(var(--topbar-height) + var(--header-height));">
  <div class="top-navbar">
    <div class="contact-info">
      <i class="fas fa-clock"></i> Poniedziałek - Piątek 9:00 - 18:00
      <span><i class="fas fa-phone"></i> +48 505 849 404</span>
    </div>

    <div class="auth-buttons" id="authButtons">
      <button class="btn btn-outline-primary btn-sm" id="loginBtn">
        <i class="fas fa-sign-in-alt"></i> Zaloguj się
      </button>
      <button class="btn btn-primary btn-sm" id="registerBtn">
        <i class="fas fa-user-plus"></i> Zarejestruj się
      </button>
    </div>

    <div class="user-menu" id="userMenu" style="display:none;">
      <button class="btn btn-outline-primary btn-sm" id="accountBtn">
        <i class="fas fa-user"></i> Moje konto
      </button>
      <button class="btn btn-secondary btn-sm" id="logoutBtn">
        <i class="fas fa-sign-out-alt"></i> Wyloguj
      </button>
    </div>
  </div>

  <header>
    <a href="index.html" class="logo">
      <img src="https://raw.githubusercontent.com/trainingtwenty5/karuzo/main/brand/logo-horizontal-dark.svg" alt="Logo serwisu">
    </a>

    <nav class="desktop-nav">
      <a href="index.html" class="nav-link">Strona główna</a>
      <a href="oferty.html" class="nav-link">Oferty</a>
      <a href="dodaj.html" class="nav-link">Dodaj</a>
      <a href="Kontakt.html" class="nav-link">Kontakt</a>
    </nav>

    <a href="dodaj.html" class="desktop-add-offer">
      <i class="fas fa-plus"></i> Dodaj ofertę
    </a>

    <a href="dodaj.html" class="mobile-add-offer">
      <i class="fas fa-plus"></i> Dodaj ofertę
    </a>

    <button class="mobile-menu-btn" aria-label="Otwórz menu">
      <i class="fas fa-bars"></i>
    </button>

    <nav class="nav-menu">
      <a href="index.html" class="nav-link">Strona główna</a>
      <a href="oferty.html" class="nav-link">Oferty</a>
      <a href="dodaj.html" class="nav-link">Dodaj</a>
      <a href="Kontakt.html" class="nav-link">Kontakt</a>
      <div class="mobile-auth" id="mobileAuth" style="display:none;"></div>
    </nav>
  </header>

  <main class="property-wrapper">
    <div id="loadingState" class="loading-state">Sprawdzanie uprawnień i wczytywanie danych...</div>
    <div id="errorState" class="error-state hidden">Brak uprawnień do edycji tej działki.</div>

    <section id="propertyContent" class="hidden" aria-live="polite">
      <p class="edit-intro">Możesz tutaj dostosować swoją ofertę.</p>
      <div class="edit-toolbar">
        <button id="saveChangesBtn" class="btn btn-primary">
          <i class="fas fa-save"></i> Zapisz zmiany
        </button>
      </div>

      <section class="property-hero" aria-labelledby="propertyTitle">
        <div class="property-heading">
          <div class="title-group">
            <h1 id="propertyTitle">Działka</h1>
            <div class="property-meta">
              <span class="meta-chip"><i class="fas fa-map-marker-alt"></i>
                <span id="propertyLocation" contenteditable="true">Polska</span></span>
              <span class="meta-chip"><i class="fas fa-ruler-combined"></i>
                <span id="propertyArea">0 m²</span></span>
              <span class="meta-chip meta-chip--select"><i class="fas fa-layer-group"></i>
                <select id="propertyTypeSelect" aria-label="Rodzaj działki">
                  <option value="">Rodzaj</option>
                  <option value="Budowlana">Budowlana</option>
                  <option value="Rolna">Rolna</option>
                  <option value="Inwestycyjna">Inwestycyjna</option>
                </select></span>
              <span class="meta-chip meta-chip--select"><i class="fas fa-landmark"></i>
                <select id="ownershipFormSelect" aria-label="Forma władania">
                  <option value="Własność">Własność</option>
                  <option value="Użytkowanie wieczyste">Użytkowanie wieczyste</option>
                </select></span>
            </div>
          </div>

          <div class="price-box" aria-live="polite">
            <div class="price-line">
              <span id="priceValueText" class="price-amount" contenteditable="true">—</span>
            </div>
            <div class="price-meta">
              <span>cena za m²: <strong id="pricePerSqm">—</strong></span>
              <span id="priceUpdatedAt">Aktualizacja: —</span>
            </div>
          </div>
        </div>

        <div class="property-stats">
          <div class="stat-card">
            <h4>Numer działki</h4>
            <p id="plotNumber">—</p>
          </div>
          <div class="stat-card">
            <h4>Numer księgi wieczystej</h4>
            <p id="landRegister" contenteditable="true">—</p>
            <p class="field-hint">Przykład: WA3M/00095878/5</p>
          </div>
          <div class="stat-card">
            <h4>Powierzchnia</h4>
            <p id="plotAreaStat">—</p>
          </div>
          <div class="stat-card">
            <h4>Status własności</h4>
            <select id="plotOwnershipSelect" aria-label="Status własności">
              <option value="">Wybierz status</option>
              <option value="Własność (pełna)">Własność (pełna)</option>
              <option value="Współwłasność ułamkowa">Współwłasność ułamkowa</option>
              <option value="Wspólność łączna">Wspólność łączna</option>
              <option value="Użytkowanie wieczyste">Użytkowanie wieczyste</option>
              <option value="Trwały zarząd">Trwały zarząd</option>
              <option value="Zarząd">Zarząd</option>
              <option value="Użytkowanie">Użytkowanie</option>
              <option value="Inny rodzaj władania">Inny rodzaj władania</option>
            </select>
          </div>
        </div>
      </section>

      <section class="property-layout" id="mapSection">
        <div class="map-panel">
          <div class="map-toolbar">
            <h3>Mapa i lokalizacja</h3>
            <div class="map-modes" role="group" aria-label="Warstwy mapy">
              <button class="map-mode-btn active" data-mode="base">Mapa</button>
              <button class="map-mode-btn" data-mode="mpzp">MPZP</button>
              <button class="map-mode-btn" data-mode="studium">Studium</button>
            </div>
          </div>
          <div id="propertyMap" role="region" aria-label="Mapa działki"></div>
          <div class="location-details">
            <div class="location-card">
              <h4>Adres</h4>
              <p id="locationAddress" contenteditable="true">Dodaj adres działki</p>
            </div>
            <div class="location-card">
              <h4>Dojazd i otoczenie</h4>
              <p id="locationAccess" contenteditable="true">Opisz komunikację, dostęp do drogi, najbliższe punkty orientacyjne.</p>
            </div>
          </div>
        </div>

        <aside class="plan-panel">
          <div class="section-header">
            <h3>Plan zagospodarowania</h3>
          </div>
          <div class="plan-badges" id="planBadges"></div>
          <div class="plan-info-grid">
            <dl><dt>Przeznaczenie</dt><dd id="planDesignation" contenteditable="true">Brak informacji</dd></dl>
            <dl><dt>Maks. wysokość</dt><dd id="planHeight" contenteditable="true">—</dd></dl>
            <dl><dt>Intensywność zabudowy</dt><dd id="planIntensity" contenteditable="true">—</dd></dl>
            <dl><dt>Pow. biologicznie czynna</dt><dd id="planGreen" contenteditable="true">—</dd></dl>
          </div>
          <div class="plan-notes" id="planNotes" contenteditable="true">Uzupełnij najważniejsze zapisy z planu miejscowego lub studium.</div>
        </aside>
      </section>

      <section class="utilities-section" aria-labelledby="utilitiesTitle">
        <div class="section-header">
          <h2 id="utilitiesTitle">Uzbrojenie terenu</h2>
          <span style="font-size:0.85rem;color:var(--gray);">Kliknij ikonę/kafelek, aby zmienić status</span>
        </div>
        <div class="utilities-grid" id="utilitiesGrid">
          <div class="utility-card" data-utility="electricity" data-status="missing">
            <div class="utility-icon">⚡</div>
            <div class="utility-content">
              <h4>Prąd</h4>
              <div class="utility-status">Brak</div>
            </div>
          </div>
          <div class="utility-card" data-utility="water" data-status="missing">
            <div class="utility-icon">💧</div>
            <div class="utility-content">
              <h4>Woda</h4>
              <div class="utility-status">Brak</div>
            </div>
          </div>
          <div class="utility-card" data-utility="gas" data-status="missing">
            <div class="utility-icon">🔥</div>
            <div class="utility-content">
              <h4>Gaz</h4>
              <div class="utility-status">Brak</div>
            </div>
          </div>
          <div class="utility-card" data-utility="sewage" data-status="missing">
            <div class="utility-icon">♻️</div>
            <div class="utility-content">
              <h4>Kanalizacja</h4>
              <div class="utility-status">Brak</div>
            </div>
          </div>
          <div class="utility-card" data-utility="fiber" data-status="missing">
            <div class="utility-icon">🌐</div>
            <div class="utility-content">
              <h4>Światłowód</h4>
              <div class="utility-status">Brak</div>
            </div>
          </div>
        </div>
      </section>

      <section class="description-section" aria-labelledby="descriptionTitle">
        <div class="section-header">
          <h2 id="descriptionTitle">Opis szczegółowy</h2>
        </div>
        <div class="description-card">
          <div id="descriptionText" class="description-text" contenteditable="true">Brak opisu</div>
        </div>
      </section>

      <section class="tags-section" aria-labelledby="tagsTitle">
        <div class="section-header">
          <h2 id="tagsTitle">Parametry dodatkowe</h2>
        </div>
        <div class="tags-card">
          <p class="tag-hint">Tagiem będzie wyszukiwana Twoja działka. Przykłady: #Budowlana, #Inwestycyjna, #Rolna, #Blisko-las, #Dojazd-asfaltowy, #Dostępne-media, #Pod-OZE.</p>
          <div class="tags-list" id="tagsList"></div>
          <p class="tags-empty" id="tagsEmpty" hidden>Brak dodatkowych parametrów.</p>
          <div class="tag-form">
            <input type="text" id="tagInput" placeholder="Dodaj własny znacznik, np. #Budowlana">
            <button class="btn btn-primary" type="button" id="addTagBtn"><i class="fas fa-plus"></i> Dodaj</button>
          </div>
          <div class="tag-suggestions-wrapper" id="tagSuggestionsWrapper" hidden>
            <p class="tag-suggestions-title">Popularne tagi (kliknij, aby dodać):</p>
            <div class="tag-suggestions" id="tagSuggestionsList"></div>
          </div>
        </div>
      </section>

      <section class="contact-section" id="contact" aria-labelledby="contactTitle">
        <div class="section-header">
          <h2 id="contactTitle">Skontaktuj się</h2>
        </div>
        <div class="contact-wrapper">
          <div class="contact-card">
            <h3 id="contactName">Właściciel</h3>
            <div class="contact-details">
              <span><i class="fas fa-phone"></i> <a href="#" id="contactPhoneLink">Brak numeru</a></span>
              <span><i class="fas fa-envelope"></i> <a href="#" id="contactEmailLink">Brak adresu</a></span>
            </div>
          </div>
        </div>
      </section>
    </section>
  </main>

  <div class="toast-container" id="toastContainer" aria-live="polite" aria-atomic="true"></div>

  <div class="modal" id="loginModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Zaloguj się</h3>
        <button class="modal-close" aria-label="Zamknij">&times;</button>
      </div>
      <form id="loginForm">
        <div class="form-group">
          <label for="loginEmail">Email</label>
          <input type="email" id="loginEmail" required>
        </div>
        <div class="form-group">
          <label for="loginPassword">Hasło</label>
          <input type="password" id="loginPassword" required>
        </div>
        <button type="submit" class="btn btn-primary w-100">Zaloguj się</button>
      </form>
      <div class="social-login">
        <button type="button" class="btn btn-google" id="googleLoginBtnLogin">
          <i class="fab fa-google"></i> Kontynuuj z Google
        </button>
      </div>

      <div class="auth-info" role="note">
        <i class="fas fa-info-circle" aria-hidden="true"></i>
        <p>Logowanie jest dostępne wyłącznie przez przycisk <strong>Kontynuuj z Google</strong>. Pozostałe pola mają charakter demonstracyjny.</p>
      </div>
      <div class="form-footer">
        <p>Nie masz konta? <a href="#" id="switchToRegister">Zarejestruj się</a></p>
      </div>
    </div>
  </div>

  <div class="modal" id="registerModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Utwórz konto</h3>
        <button class="modal-close" aria-label="Zamknij">&times;</button>
      </div>
      <form id="registerForm">
        <div class="form-group">
          <label for="registerEmail">Email</label>
          <input type="email" id="registerEmail" required>
        </div>
        <div class="form-group">
          <label for="registerPassword">Hasło</label>
          <input type="password" id="registerPassword" required>
        </div>
        <button type="submit" class="btn btn-primary w-100">Zarejestruj się</button>
      </form>
      <div class="social-login">
        <button type="button" class="btn btn-google" id="googleLoginBtn">
          <i class="fab fa-google"></i> Kontynuuj z Google
        </button>
      </div>

      <div class="auth-info" role="note">
        <i class="fas fa-info-circle" aria-hidden="true"></i>
        <p>Rejestracja jest dostępna wyłącznie przez przycisk <strong>Kontynuuj z Google</strong>. Formularz e-mail służy celom demonstracyjnym.</p>
      </div>
      <div class="form-footer">
        <p>Masz już konto? <a href="#" id="switchToLogin">Zaloguj się</a></p>
      </div>
    </div>
  </div>

  <footer id="contact">
    <div class="container">
      <div class="footer-container">
        <div class="footer-about">
          <a href="index.html" class="footer-logo">
            <img src="https://raw.githubusercontent.com/trainingtwenty5/karuzo/main/brand/logo-horizontal-dark.svg" alt="Logo serwisu">
          </a>
          <p>Bezpłatne ogłoszenia nieruchomości. Szybka sprzedaż działek bez zbędnych kosztów i formalności.</p>
        </div>

        <div class="footer-links">
          <h3>Przydatne linki</h3>
          <ul>
            <li><a href="index.html">Strona główna</a></li>
            <li><a href="oferty.html">Oferty</a></li>
            <li><a href="dodaj.html">Dodaj ofertę</a></li>
            <li><a href="RODO.html">Informacja RODO</a></li>
            <li><a href="polityka-prywatnosci.html">Polityka prywatności</a></li>
            <li><a href="Kontakt.html">Kontakt</a></li>
          </ul>
        </div>

        <div class="footer-contact">
          <h3>Kontakt</h3>
          <p><i class="fas fa-envelope"></i> info@grunteo.pl</p>
          <p><i class="fas fa-phone"></i> +48 123 456 789</p>
        </div>
      </div>

      <div class="footer-bottom">
        © 2025. Wszelkie prawa zastrzeżone.
      </div>
    </div>
  </footer>

  <script type="module" src="assets/edit.js"></script>
</body>
</html>
